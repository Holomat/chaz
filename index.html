<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MEC | Editorial Studio</title>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;700;800&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-global: #F9F9F9;
            --accent: #0C4754;
            --accent-hover: #08323B;
            --text-main: #1D1D1F;
            --text-mute: #86868B;
            --input-bg: #EEEEF0;
            --card-bg: #FFFFFF;
            --radius-main: 28px;
            --radius-ui: 12px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-font-smoothing: antialiased; }
        
        body { 
            font-family: 'Inter', sans-serif; 
            background: var(--bg-global); 
            height: 100vh; 
            display: flex; 
            align-items: center; 
            color: var(--text-main); 
            overflow: hidden; 
        }
        
        /* COLUMNA PANEL IZQUIERDO */
        .sidebar-column {
            width: 33.33vw; 
            height: 100%;
            display: flex;
            justify-content: center; 
            align-items: center;
            padding: 20px;
            z-index: 10;
        }

        .sidebar { 
            width: 340px; 
            max-height: 92vh; 
            background: var(--card-bg); 
            padding: 28px 24px; 
            display: flex; 
            flex-direction: column; 
            gap: 16px;
            overflow-y: auto; 
            border-radius: var(--radius-main);
            box-shadow: 0 10px 40px rgba(0,0,0,0.05);
            scrollbar-width: none;
        }
        .sidebar::-webkit-scrollbar { display: none; }
        
        header { margin-bottom: 4px; padding: 0 8px; }
        .brand-logo { width: 100%; max-width: 170px; height: auto; display: block; }
        
        .form-group { display: flex; flex-direction: column; gap: 5px; padding: 0 8px; }
        
        label { 
            font-size: 10px; font-weight: 700; color: var(--text-mute);
            text-transform: uppercase; letter-spacing: 0.05em;
        }
        
        .ui-card {
            height: 36px; padding: 0 14px; border: 1px solid transparent;
            border-radius: var(--radius-ui); background: var(--input-bg);
            display: flex; align-items: center; transition: all 0.2s ease;
            width: 100%; font-family: 'Inter', sans-serif; font-size: 13px;
            color: var(--text-main); appearance: none;
        }

        .ui-card:hover { background: #E5E5E7; }
        input[type="text"].ui-card:focus, select.ui-card:focus {
            outline: none; background: #FFFFFF; border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(12, 71, 84, 0.08);
        }

        .file-label { 
            background: var(--text-main); color: #FFFFFF; cursor: pointer; 
            justify-content: center; font-weight: 600; font-size: 12px;
        }

        .scale-slider {
            -webkit-appearance: none; width: 100%; height: 4px;
            background: #D2D2D7; border-radius: 2px; outline: none;
        }
        .scale-slider::-webkit-slider-thumb {
            -webkit-appearance: none; width: 16px; height: 16px;
            background: #FFFFFF; border: 0.5px solid rgba(0,0,0,0.1);
            border-radius: 50%; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.15);
        }

        .color-row { width: 100%; display: flex; justify-content: space-between; align-items: center; }
        .color-dot { width: 20px; height: 20px; border-radius: 50%; cursor: pointer; transition: transform 0.2s; border: 2px solid transparent; }
        .color-dot.active { border-color: var(--text-main); transform: scale(1.1); }

        .download-btn { 
            background: var(--accent); color: white; border: none; 
            height: 44px; min-height: 44px; border-radius: var(--radius-ui); 
            font-weight: 700; font-size: 13px; cursor: pointer; 
            margin-top: 8px; transition: all 0.2s ease;
        }
        .download-btn:hover { background: var(--accent-hover); transform: translateY(-2px); }

        /* CANVAS CONTAINER */
        .canvas-container { 
            flex: 1; 
            height: 100%;
            display: flex; 
            align-items: center; 
            justify-content: center; 
            z-index: 5;
        }

        .poster { 
            width: 540px; height: 675px; background: #FFFFFF; position: relative; 
            overflow: hidden; border-radius: 4px;
            box-shadow: 0 40px 80px rgba(0,0,0,0.1);
        }

        #bgWrapper { position: absolute; top: 0; left: 0; width: 100%; height: 100%; cursor: move; }
        #bgPreview { position: absolute; transform-origin: center center; pointer-events: none; }
        
        #logoContainer { position: absolute; left: 36px; bottom: 32px; width: 42px; z-index: 50; }
        .logo { width: 100%; height: auto; display: block; }

        .text-container { position: absolute; left: 40px; right: 58px; bottom: 88px; z-index: 40; pointer-events: none; display: flex; flex-direction: column; justify-content: flex-end; min-height: 200px; }
        .etiqueta, .subtitle { font-family: 'Sora'; font-size: 20px; font-weight: 400; letter-spacing: -0.04em; }
        .etiqueta { margin-bottom: 12px; text-transform: uppercase; }
        .title { font-family: 'Sora'; font-size: 40px; font-weight: 300; line-height: 0.95; white-space: pre-line; letter-spacing: -0.05em; }
        .title.has-subtitle { margin-bottom: 16px; }
        .bold-part { font-weight: 800 !important; }

        /* COLUMNA DERECHA (GUÍA) */
        .guide-column {
            width: 33.33vw;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            z-index: 10;
        }

        .guide-toggle {
            width: 340px;
            height: 40px;
            background: var(--accent);
            color: white;
            border-radius: var(--radius-ui);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            box-shadow: 0 4px 12px rgba(12, 71, 84, 0.15);
            transition: all 0.3s ease;
            margin-bottom: 12px;
        }

        .right-sidebar {
            width: 340px;
            max-height: 0; 
            opacity: 0;
            background: var(--card-bg);
            border-radius: var(--radius-main);
            box-shadow: 0 10px 40px rgba(0,0,0,0.05);
            transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .right-sidebar.active {
            max-height: 85vh;
            opacity: 1;
            padding: 28px 24px;
            overflow-y: auto;
        }
        .right-sidebar::-webkit-scrollbar { display: none; }

        /* ICONO EJE DEL MES */
        .objective-icon {
            width: 48px;
            height: 48px;
            color: var(--accent);
            margin-bottom: 16px;
            opacity: 0;
            transform: scale(0.8) translateY(10px);
            transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) 0.3s;
        }
        .right-sidebar.active .objective-icon {
            opacity: 1;
            transform: scale(1) translateY(0);
        }

        .guide-content h2 { font-family: 'Sora'; font-size: 18px; color: var(--accent); margin-bottom: 4px; }
        .guide-date { font-size: 11px; font-weight: 700; color: var(--text-mute); text-transform: uppercase; margin-bottom: 12px; display: block; }
        
        .guide-section { margin-bottom: 22px; }
        .guide-section h3 { font-size: 10px; color: var(--accent); text-transform: uppercase; margin-bottom: 8px; font-weight: 800; letter-spacing: 0.05em; }
        .guide-section p { font-size: 13px; line-height: 1.5; color: var(--text-main); }
        
        .narrative-strategy {
            background: #fdfdfd;
            border: 1px solid #ededed;
            border-radius: var(--radius-ui);
            padding: 12px;
            margin-top: 8px;
        }
        .narrative-item { margin-bottom: 8px; font-size: 12px; }
        .narrative-label { font-weight: 700; font-size: 9px; text-transform: uppercase; display: block; margin-bottom: 2px; }
        .n-antes { color: #bcbcbc; text-decoration: line-through; }
        .n-despues { color: var(--accent); font-weight: 500; }
        .n-despues::before { content: "→ "; font-weight: 800; }

        .tips-list { list-style: none; }
        .tips-list li { font-size: 12.5px; line-height: 1.4; margin-bottom: 10px; padding-left: 15px; position: relative; color: var(--text-main); }
        .tips-list li::before { content: "•"; position: absolute; left: 0; color: var(--accent); font-weight: bold; }

        .checklist { background: #F0F9FA; padding: 14px; border-radius: var(--radius-ui); }
        .checklist li { font-size: 12px; margin-bottom: 6px; list-style: none; display: flex; align-items: center; gap: 8px; color: var(--accent); font-weight: 500; }
        .checklist li::before { content: "☐"; font-size: 14px; }
    </style>
</head>
<body>

    <div class="sidebar-column">
        <div class="sidebar">
            <header>
                <img src="https://i.imgur.com/FakCT9f.png" alt="MEC Studio" class="brand-logo">
            </header>
            
            <div class="form-group">
                <label>Imagen de Fondo</label>
                <label for="bgInput" class="ui-card file-label">Cargar archivo</label>
                <input type="file" id="bgInput" accept="image/*" style="display: none;">
            </div>

            <div class="form-group">
                <label>Escala de imagen</label>
                <div class="ui-card" style="background: transparent; padding: 0;">
                    <input type="range" id="scaleInput" class="scale-slider" min="0.1" max="3" step="0.01" value="1">
                </div>
            </div>

            <div class="form-group">
                <label>Categoría</label>
                <input type="text" id="etiquetaIn" class="ui-card" placeholder="Ej: Taller [Virtual]" spellcheck="false">
            </div>

            <div class="form-group">
                <label>Título Principal</label>
                <input type="text" id="titleIn" class="ui-card" placeholder="Ej: Dirección de [Educación]" spellcheck="false">
            </div>

            <div class="form-group">
                <label>Subtítulo / Bajada</label>
                <input type="text" id="subtitleIn" class="ui-card" placeholder="Opcional" spellcheck="false">
            </div>
            
            <div class="form-group">
                <label>Tono de Marca</label>
                <div class="ui-card" style="background: transparent; border: 1px solid #EEEEF0; padding: 0 10px;">
                    <div class="color-row">
                        <div class="color-dot active" style="background: #E8E0FF;" data-color="#E8E0FF"></div>
                        <div class="color-dot" style="background: #FFD0EF;" data-color="#FFD0EF"></div>
                        <div class="color-dot" style="background: #D1FFC0;" data-color="#D1FFC0"></div>
                        <div class="color-dot" style="background: #D2FFE8;" data-color="#D2FFE8"></div>
                        <div class="color-dot" style="background: #DDFF9D;" data-color="#DDFF9D"></div>
                        <div class="color-dot" style="background: #C0FFCA;" data-color="#C0FFCA"></div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>Unidad Ejecutora</label>
                <select id="programaIn" class="ui-card">
                    <option value="">General</option>
                    <option value="Cecap">Cecap</option>
                    <option value="Pas">Pas</option>
                    <option value="Pnec">Pnec</option>
                    <option value="Cultura científica">Cultura científica</option>
                    <option value="DNE" selected>DNE</option>
                </select>
            </div>

            <button class="download-btn" onclick="downloadPoster()">Descargar Afiche</button>
        </div>
    </div>

    <div class="canvas-container">
        <div class="poster" id="posterArea">
            <div id="bgWrapper"><img id="bgPreview" src=""></div>
            <div id="logoContainer">
                <svg class="logo" viewBox="0 0 88 81" id="logoSvg">
                    <path d="M81.0034 17.2512V8H53.2558H44.0312V17.2512V26.5488V35.7907V45.0884V54.3396H53.2558H81.0034V45.0884H53.2558V35.7907H81.0034V26.5488H53.2558V17.2512H81.0034Z" fill="currentColor"/>
                    <path d="M20.9248 8C13.2393 8 7 14.248 7 21.9651C7 29.6822 13.23 35.9302 20.9248 35.9302C28.6196 35.9302 34.8497 29.6822 34.8497 21.9651C34.8497 14.248 28.6196 8 20.9248 8ZM20.9248 26.6325C18.3568 26.6325 16.2709 24.5406 16.2709 21.9651C16.2709 19.3896 18.3568 17.2977 20.9248 17.2977C23.4929 17.2977 25.5788 19.3896 25.5788 21.9651C25.5788 24.5406 23.4929 26.6325 20.9248 26.6325Z" fill="currentColor"/>
                    <path d="M34.8497 45.0977H7V54.4046H34.8497V45.0977Z" fill="currentColor"/>
                    <path d="M80.9907 63.6934H7V73.0003H80.9907V63.6934Z" fill="currentColor"/>
                </svg>
            </div>
            <div class="text-container" id="textContainer">
                <div class="etiqueta" id="etiquetaShow"></div>
                <div class="title" id="titleShow"></div>
                <div class="subtitle" id="subtitleShow"></div>
            </div>
        </div>
    </div>

    <div class="guide-column">
        <div class="guide-toggle" onclick="toggleGuide()">Eje del Mes</div>
        <div class="right-sidebar" id="rightSidebar">
            <div class="guide-content">
                <svg class="objective-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <circle cx="12" cy="12" r="6"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                    <path d="M22 2l-6 6"></path>
                    <path d="M12 2v2"></path>
                    <path d="M12 20v2"></path>
                    <path d="M2 12h2"></path>
                    <path d="M20 12h2"></path>
                </svg>

                <span class="guide-date">Mayo 2026</span>
                <h2>Acompañamiento Pedagógico</h2>
                
                <div class="guide-section" style="margin-top: 12px;">
                    <h3>Definición Académica</h3>
                    <p>Proceso de mediación estratégica para fortalecer prácticas de aprendizaje, basado en el intercambio horizontal y el apoyo sostenido.</p>
                </div>

                <div class="guide-section">
                    <h3>Aplicación Narrativa</h3>
                    <div class="narrative-strategy">
                        <div class="narrative-item">
                            <span class="narrative-label">Transformación del Título:</span>
                            <div class="n-antes">Taller de Capacitación Técnica</div>
                            <div class="n-despues">Herramientas para potenciar tu aula</div>
                        </div>
                        <div class="narrative-item" style="margin-bottom:0;">
                            <span class="narrative-label">Concepto Clave:</span>
                            <span style="font-style: italic;">"El MEC sostiene el camino de quien aprende."</span>
                        </div>
                    </div>
                </div>

                <div class="guide-section">
                    <h3>Tips de Comunicación</h3>
                    <ul class="tips-list">
                        <li><strong>Acción:</strong> Caminar, fortalecer, potenciar.</li>
                        <li><strong>Imagen:</strong> Prioriza interacción humana real.</li>
                        <li><strong>Título:</strong> Enmarca el beneficio, no lo técnico.</li>
                    </ul>
                </div>

                <div class="guide-section">
                    <h3>Checklist Visual</h3>
                    <div class="checklist">
                        <li>¿Se ve interacción humana?</li>
                        <li>¿El título invita a participar?</li>
                        <li>¿El tono de color es cálido?</li>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        function toggleGuide() {
            document.getElementById('rightSidebar').classList.toggle('active');
        }

        const inputs = {
            etiqueta: document.getElementById('etiquetaIn'),
            title: document.getElementById('titleIn'),
            subtitle: document.getElementById('subtitleIn'),
            programa: document.getElementById('programaIn')
        };
        const logoSvg = document.getElementById('logoSvg');
        const textContainer = document.getElementById('textContainer');
        const scaleInput = document.getElementById('scaleInput');
        let currentColor = "#E8E0FF";
        let currentScale = 1;

        function processHTML(text) {
            return text.replace(/\[(.*?)\]/g, '<span class="bold-part">$1</span>');
        }

        function syncText() {
            let labelText = inputs.etiqueta.value;
            if(inputs.programa.value) labelText += ` | [${inputs.programa.value}]`;
            document.getElementById('etiquetaShow').innerHTML = processHTML(labelText);
            const titleEl = document.getElementById('titleShow');
            titleEl.innerHTML = processHTML(inputs.title.value);
            document.getElementById('subtitleShow').innerHTML = processHTML(inputs.subtitle.value);
        }

        function applyGlobalColor(hex) {
            currentColor = hex;
            textContainer.style.color = hex;
            logoSvg.style.color = hex;
        }

        Object.values(inputs).forEach(input => input.oninput = syncText);
        inputs.programa.onchange = syncText;

        document.querySelectorAll('.color-dot').forEach(dot => {
            dot.addEventListener('click', () => {
                document.querySelector('.color-dot.active').classList.remove('active');
                dot.classList.add('active');
                applyGlobalColor(dot.dataset.color);
            });
        });

        const bgInput = document.getElementById('bgInput');
        const bgPreview = document.getElementById('bgPreview');
        const bgWrapper = document.getElementById('bgWrapper');
        let posX = 0, posY = 0, isDragging = false, startX, startY;

        function updateTransform() {
            bgPreview.style.transform = `translate(${posX}px, ${posY}px) scale(${currentScale})`;
        }

        bgInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (event) => {
                bgPreview.src = event.target.result;
                bgPreview.onload = () => {
                    const imgAspect = bgPreview.naturalWidth / bgPreview.naturalHeight;
                    if (imgAspect > (540/675)) { bgPreview.style.height = '675px'; bgPreview.style.width = 'auto'; }
                    else { bgPreview.style.width = '540px'; bgPreview.style.height = 'auto'; }
                    updateTransform();
                }
            };
            reader.readAsDataURL(file);
        });

        scaleInput.oninput = (e) => { currentScale = parseFloat(e.target.value); updateTransform(); };
        bgWrapper.onmousedown = (e) => { if(!bgPreview.src) return; isDragging = true; startX = e.clientX - posX; startY = e.clientY - posY; };
        window.onmousemove = (e) => { if (!isDragging) return; posX = e.clientX - startX; posY = e.clientY - startY; updateTransform(); };
        window.onmouseup = () => isDragging = false;

        async function downloadPoster() {
            const poster = document.getElementById('posterArea');
            const canvas = await html2canvas(poster, {
                scale: 3, useCORS: true, allowTaint: true, backgroundColor: "#FFFFFF"
            });
            const link = document.createElement('a');
            link.download = 'afiche-mec.png';
            link.href = canvas.toDataURL('image/png', 1.0);
            link.click();
        }

        inputs.etiqueta.value = "Taller [Virtual]";
        inputs.title.value = "Dirección Nacional de\n[Educación] 2026";
        inputs.subtitle.value = "Resumen de gestión a un año desde marzo a diciembre";
        applyGlobalColor(currentColor);
        syncText();
    </script>
</body>
</html>
